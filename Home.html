<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="Home.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"/>
  <title>www.delight.pk</title>
</head>
<body>

  <div class="bar">
    <a href="Home.html"><img src="Home.png" width="25" height="25"><br>Home</a>
    <a href="Categories.html"><img src="Categories.png" width="25" height="25"><br>Categories</a>
    <a href="cart.html"><img src="Cart.png" width="25" height="25"><br>Cart</a>
    <a href="profile.html"><img src="Profile.png" width="25" height="25"><br>Profile</a>
  </div>

  <h2 style="border:2px solid #ffb300">ELIGHT.PK</h2>

  <!-- ✅ Swiper Slider -->
  <div class="swiper mySwiper">
    <div class="swiper-wrapper">
      <div class="swiper-slide"><img src="Ad1.jpg"></div>
      <div class="swiper-slide"><img src="Ad2.jpg"></div>
      <div class="swiper-slide"><img src="Ad4.jpeg"></div>
      <div class="swiper-slide"><img src="Ad5.png"></div>
      <div class="swiper-slide"><img src="Ad6.jpeg"></div>
      <div class="swiper-slide"><img src="Ad7.png"></div>
      <div class="swiper-slide"><img src="Ad3.jpg"></div>
    </div>
    <div class="swiper-pagination"></div>
  </div>

  <div class="logo">
    <img src="lo.png" width="40" height="30">
  </div>

  <!-- 🔥 Flash Sale Section -->
  <div class="flash-sale-box">
    <h3>🔥 One Buy and One Free</h3>
    <div id="flashCardContainer">
      <h3><span id="flashTimer" class="timer">Ends in: 00:00:00</span></h3>
    </div>
  </div>
  <script src="flashsale.js"></script>

  <!-- Flash Sale Products -->
  <div class="flash-sale-section">
    <div class="flash-sale-heading">🔥 Flash Sale</div>
    <div id="flashSaleContainer" class="flash-sale-grid"></div>
  </div>

  <!-- Search -->
  <div>
    <input type="text" id="searchInput" class="search" placeholder="🔍 Search...">
    <button onclick="searchItems()" class="btn">Search</button>
  </div>

  <!-- Items -->
  <div class="container" id="itemContainer"></div>

  <script src="itemData.js"></script>
<script>
  const container = document.getElementById("itemContainer");

  // ✅ Get global profit & discount from flashsale.js
  const profit = typeof globalProfit !== 'undefined' ? globalProfit : 0;
  const discount = typeof globalDiscount !== 'undefined' ? globalDiscount : 0;

  // 🔀 Shuffle function
  function shuffleArray(array) {
    for (let i = array.length - 1; i > 0; i--) {
      const j = Math.floor(Math.random() * (i + 1));
      [array[i], array[j]] = [array[j], array[i]];
    }
    return array;
  }

  // ✅ Shuffle items instead of reverse
  const shuffledItems = shuffleArray([...items]);

  shuffledItems.forEach(item => {
    const card = document.createElement("div");
    card.className = "item-card";

    // Calculate prices
    const basePrice = parseInt(item.price?.replace("Rs.", "").trim()) || 0;
    const originalPrice = basePrice + profit;
    const finalPrice = originalPrice - discount;

    // Create HTML
    card.innerHTML = `
      <img src="${item.image}" alt="${item.title}">
      <h3>${item.title}</h3>
      <p class="price-wrapper">
        <span class="new-price">
          <span class="rs">R<span class="s">s.</span></span>
          <strong>${finalPrice}</strong>
        </span><br>
        <span class="old-price">
          <span class="rs">Rs.</span>
          <span>${originalPrice}</span>
        </span>
      </p>
    `;

    // ✅ On card click
    card.addEventListener('click', () => {
      const updatedItem = {
        ...item,
        originalPrice,
        finalPrice
      };
      localStorage.setItem("selectedItem", JSON.stringify(updatedItem));
      window.location.href = "itemDetails.html";
    });

    container.appendChild(card);
  });
</script>

<script>
    function searchItems() {
      const searchText = document.getElementById("searchInput").value.trim().toLowerCase();
      const filtered = items.filter(item => {
        const title = item.title.toLowerCase().replace(/\s+/g, '');
        const search = searchText.replace(/\s+/g, '');
        return title.includes(search);
      });

      if (filtered.length > 0) {
        localStorage.setItem("searchResults", JSON.stringify(filtered));
        window.location.href = "searchResults.html";
      } else {
        localStorage.removeItem("searchResults");
        window.location.href = "searchResults.html";
      }
    }
</script>

  <!-- ✅ Swiper Script -->
  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>
  <script>
    const swiper = new Swiper(".mySwiper", {
      loop: true,
      autoplay: {
        delay: 3000,
        disableOnInteraction: false,
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
    });
  </script>

  <script src="sale.js"></script>
<script>
  const flashContainer = document.getElementById("flashSaleContainer");

  flashSaleProducts.forEach(product => {
    const card = document.createElement("div");
    card.className = "flash-sale-card";
    card.innerHTML = `
      <div class="discount-badge">SAVE ${product.discountPercentage}%</div>
      <img src="${product.images[0]}" alt="${product.title}">
      <div class="price-block">
        <span style="color:#ef6c00;font-weight:bold;">Rs. ${product.finalPrice}</span>
        <span class="old-price">Rs. ${product.price}</span>
      </div>
      ${product.stock === 1 ? `<div class="stock-badge">1 Stock left</div>` : ""}
      ${product.sold ? `<div class="sold-badge">${product.sold} sold</div>` : ""}
    `;

    card.addEventListener("click", () => {
      localStorage.setItem("selectedItem", JSON.stringify(product));
      window.location.href = "itemDetails.html";
    });

    flashContainer.appendChild(card);
  });
</script>

</body>
</html>